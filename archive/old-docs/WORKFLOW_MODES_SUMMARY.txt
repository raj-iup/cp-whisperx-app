================================================================================
WORKFLOW MODES IMPLEMENTATION - ANY-TO-ANY LANGUAGE SUPPORT
November 14, 2025
================================================================================

OBJECTIVE:
Add workflow modes with ANY-TO-ANY language support:
1. --transcribe-only     : Transcription in ANY source language (90+ supported)
2. --translate-only      : Translation from ANY source to ANY target language

LANGUAGE SUPPORT:
✅ 90+ languages supported by Whisper
✅ Any-to-any language pairs (e.g., Hindi→English, Spanish→French, Japanese→German)
✅ Auto-detection for source language
✅ Multiple subtitle tracks from single transcription

CURRENT WORKFLOWS:
- --subtitle-gen (default) : Full 15-stage pipeline (optimized for Hindi→English)
- --transcribe             : Basic transcription only (3 stages, minimal)

NEW WORKFLOWS:

1. --transcribe-only (6 STAGES, ~40% TIME)
   ✅ Demux, TMDB, Pre-NER, Silero VAD, PyAnnote VAD, ASR
   ❌ Skip all translation, subtitle gen, mux stages
   
   Arguments:
   --transcribe-only
   --source-language CODE   (e.g., hi, es, ja, fr, de, auto)
   
   Output: 06_asr/segments.json (transcript in source language)
   
   Use cases:
   - Transcription in any language
   - Source-only subtitles
   - Pre-translation review
   - Multiple translations from one source
   - Testing/debugging

2. --translate-only (9 STAGES, ~60% TIME)
   ✅ TMDB, Song Bias, Lyrics, Bias Correction, Diarization,
      Glossary, Translation, Post-NER, Subtitle Gen, Mux
   ❌ Skip audio processing (demux, VAD, ASR)
   
   Arguments:
   --translate-only
   --source-language CODE   (e.g., hi, es, ja, fr)
   --target-language CODE   (e.g., en, es, fr, de)
   
   Prerequisite: Must have 06_asr/segments.json from previous run
   Output: 14_subtitle_gen/subtitles.srt (in target language)
   
   Use cases:
   - Re-translate without re-transcribing
   - Multiple subtitle tracks (EN + ES + FR + DE from same source)
   - A/B testing translation settings
   - Faster iteration on quality
   - Separate transcription/translation teams

SUPPORTED LANGUAGES:

Popular Languages:
- South Asian: Hindi (hi), Urdu (ur), Tamil (ta), Telugu (te), Bengali (bn)
- European: English (en), Spanish (es), French (fr), German (de), Italian (it)
- East Asian: Japanese (ja), Korean (ko), Chinese (zh), Mandarin
- Middle Eastern: Arabic (ar), Turkish (tr), Persian (fa), Hebrew (he)
- Others: Portuguese (pt), Russian (ru), Dutch (nl), Polish (pl)
  Vietnamese (vi), Indonesian (id), Thai (th), Swedish (sv), Danish (da)

Total: 90+ languages supported by Whisper

ANY-TO-ANY Examples:
✅ Hindi → English
✅ Spanish → French
✅ Japanese → German  
✅ Arabic → Spanish
✅ Korean → English
✅ French → Portuguese
✅ And ANY combination!

USAGE EXAMPLES:

# Example 1: Spanish to English
./prepare-job.sh "movie.mp4" --transcribe-only --source-language es
./run_pipeline.sh -j <job-id>

./prepare-job.sh "movie.mp4" --translate-only \
  --source-language es --target-language en
./run_pipeline.sh -j <job-id>

# Example 2: Japanese to multiple targets
./prepare-job.sh "anime.mp4" --transcribe-only --source-language ja
./run_pipeline.sh -j <job-id>

# → English
./prepare-job.sh "anime.mp4" --translate-only \
  --source-language ja --target-language en

# → Spanish  
./prepare-job.sh "anime.mp4" --translate-only \
  --source-language ja --target-language es

# → French
./prepare-job.sh "anime.mp4" --translate-only \
  --source-language ja --target-language fr

# Result: 3 subtitle tracks from 1 transcription!

# Example 3: Auto-detect language
./prepare-job.sh "movie.mp4" --transcribe-only
# Whisper auto-detects: Hindi, Spanish, Japanese, etc.

./prepare-job.sh "movie.mp4" --translate-only \
  --source-language auto --target-language en

# Example 4: Default Bollywood workflow (unchanged)
./prepare-job.sh "movie.mp4" --subtitle-gen
# Same as: --source-language hi --target-language en

WORKFLOW COMPARISON:

| Mode               | Languages | Stages | Time | Output                  |
|--------------------|-----------|--------|------|-------------------------|
| --subtitle-gen     | hi → en   | 15     | 100% | English subs + video    |
| --transcribe-only  | any       | 6      | 40%  | Source transcript       |
| --translate-only   | any → any | 9      | 60%  | Target subs from source |
| --transcribe       | any       | 3      | 20%  | Raw transcription       |

BENEFITS:

1. Language Flexibility
   - 90+ languages supported
   - Any-to-any combinations
   - Auto-detection available
   - Multiple targets from one source

2. Performance
   - 40% time for transcription only
   - 60% time for translation only
   - Reuse expensive ASR transcription
   - Generate 3 subtitle tracks in 160% time vs 300%

3. Quality
   - Review source before translating
   - Test different target languages
   - Iterate on translation without audio processing
   - A/B test glossaries

4. Cost Effective
   - Transcribe once, translate many times
   - Share source transcript with teams
   - Test translation settings quickly

CONFIGURATION OVERRIDES:

--transcribe-only:
  WORKFLOW_MODE=transcribe-only
  SOURCE_LANGUAGE=<user-specified>   # e.g., hi, es, ja, fr
  WHISPER_TASK=transcribe
  SECOND_PASS_ENABLED=false
  (Disables: translation, lyrics, diarization, subtitle gen, mux)

--translate-only:
  WORKFLOW_MODE=translate-only
  SOURCE_LANGUAGE=<user-specified>   # e.g., hi, es, ja
  TARGET_LANGUAGE=<user-specified>   # e.g., en, es, fr, de
  SECOND_PASS_ENABLED=true
  STEP_SUBTITLE_GEN=true
  (Disables: demux, VAD, ASR - reuses existing segments.json)

BACKWARD COMPATIBILITY:
✅ Existing --subtitle-gen unchanged (remains Hindi→English default)
✅ Existing --transcribe unchanged
✅ New modes are opt-in
✅ Old jobs continue to work
✅ Can run translate-only on old jobs if segments.json exists

IMPLEMENTATION STEPS:

Phase 1: prepare-job.py
  - Add --transcribe-only and --translate-only arguments
  - Add --source-language and --target-language arguments
  - Validate language codes (90+ supported)
  - Add workflow configurations with language settings
  - Validate segments.json exists for translate-only

Phase 2: prepare-job.sh
  - Add workflow and language argument parsing
  - Update usage/help text with language examples
  - Pass language flags to Python script

Phase 3: prepare-job.ps1
  - Same as .sh but PowerShell syntax
  - Add language parameters

Phase 4: pipeline.py
  - Add get_stages_for_workflow() method
  - Validate prerequisites (segments.json for translate-only)
  - Pass language settings to ASR and translation stages
  - Update progress logging

Phase 5: Documentation
  - Update README.md with multi-language examples
  - Create WORKFLOW_MODES_GUIDE.md with language matrix
  - Document all 90+ supported languages
  - Add real-world use cases

Phase 6: Testing
  - Test multiple language pairs
  - Verify auto-detection
  - Test multi-target workflows
  - Verify backward compatibility

REAL-WORLD USE CASES:

1. International Film Distribution
   - Transcribe: Spanish film
   - Translate: → English, French, German, Portuguese
   - Result: 4 subtitle tracks for global release

2. Anime Localization
   - Transcribe: Japanese anime
   - Translate: → English, Spanish, French, German, Portuguese
   - Result: 5 subtitle tracks

3. Bollywood International (Current)
   - Transcribe: Hindi film
   - Translate: → English (current), + Spanish, French (new)
   - Result: 3 subtitle tracks for different markets

4. Documentary Localization
   - Transcribe: English documentary
   - Translate: → Hindi, Spanish, French, Arabic, Chinese
   - Result: 5 language versions

5. Content Review Pipeline
   - Step 1: Quick transcribe-only for review
   - Step 2: If approved, translate to multiple targets
   - Step 3: A/B test different glossaries per market

TESTING PLAN:

Test 1: Spanish to English
  ./prepare-job.sh "test.mp4" --transcribe-only --source-language es
  ./prepare-job.sh "test.mp4" --translate-only \
    --source-language es --target-language en

Test 2: Japanese to Multiple Targets
  ./prepare-job.sh "anime.mp4" --transcribe-only --source-language ja
  ./prepare-job.sh "anime.mp4" --translate-only -s ja -t en
  ./prepare-job.sh "anime.mp4" --translate-only -s ja -t es
  ./prepare-job.sh "anime.mp4" --translate-only -s ja -t fr

Test 3: Auto-Detection
  ./prepare-job.sh "mystery.mp4" --transcribe-only
  # Verify: Language correctly detected

Test 4: Backward Compatibility
  ./prepare-job.sh "bollywood.mp4" --subtitle-gen
  # Verify: Still works as Hindi→English

NEXT STEPS:
1. ✅ Create ANY-TO-ANY implementation plan
2. ⏳ Implement language support in prepare-job.py
3. ⏳ Add language arguments to prepare-job.sh/.ps1
4. ⏳ Update pipeline.py with language passing
5. ⏳ Update ASR and translation stages for any language
6. ⏳ Create comprehensive language documentation
7. ⏳ Test major language pairs
8. ⏳ Update README with multi-language examples

LANGUAGE CODE REFERENCE (Quick):
  hi=Hindi, es=Spanish, fr=French, de=German, it=Italian
  ja=Japanese, ko=Korean, zh=Chinese
  ar=Arabic, ru=Russian, pt=Portuguese, tr=Turkish
  auto=Auto-detect (Whisper determines language)

================================================================================
DETAILED DOCUMENTATION: docs/WORKFLOW_MODES_IMPLEMENTATION.md
================================================================================
