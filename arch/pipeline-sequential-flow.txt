CP-WHISPERX PIPELINE - SEQUENTIAL ARCHITECTURE
===============================================

ğŸ¬ INPUT: MP4 Video File
â”‚
â”œâ”€â–º [1] DEMUX (10m timeout)
â”‚   â””â”€â–º out/{movie}/audio/audio.wav (16kHz mono)
â”‚       â”‚
â”‚       â”œâ”€â–º [2] TMDB (2m timeout)
â”‚       â”‚   â””â”€â–º out/{movie}/metadata/tmdb_data.json
â”‚       â”‚       â”‚
â”‚       â”‚       â”œâ”€â–º [3] PRE-NER (5m timeout)
â”‚       â”‚       â”‚   â””â”€â–º out/{movie}/entities/pre_ner.json
â”‚       â”‚       â”‚       â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º [4] SILERO-VAD (30m timeout)
â”‚       â”‚       â”‚       â”‚   â””â”€â–º out/{movie}/vad/silero_segments.json
â”‚       â”‚       â”‚       â”‚       â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º [5] PYANNOTE-VAD (60m timeout)
â”‚       â”‚       â”‚       â”‚       â”‚   â””â”€â–º out/{movie}/vad/pyannote_segments.json
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º [6] DIARIZATION (30m timeout)
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚   â””â”€â–º out/{movie}/diarization/speaker_segments.json
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º [7] ASR (60m timeout)
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚   â””â”€â–º out/{movie}/transcription/transcript.json
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
â”‚       â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º [8] POST-NER (10m timeout)
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚   â””â”€â–º out/{movie}/entities/post_ner.json
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º [9] SUBTITLE-GEN (5m timeout)
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚   â””â”€â–º out/{movie}/subtitles/subtitles.srt
â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º [10] MUX (10m timeout)
â”‚                                                                         â”‚   â””â”€â–º out/{movie}/final_output.mp4
â”‚
â””â”€â–º ğŸï¸  OUTPUT: Movie with embedded English subtitles


DATA FLOW LEGEND
================
â”‚  : Sequential flow
â”œâ”€â–º: Stage input
â””â”€â–º: Stage output
â”¼â”€â–º: Multiple inputs converge


STAGE DEPENDENCIES
==================
Stage 1  (demux)        : None - starts the pipeline
Stage 2  (tmdb)         : demux
Stage 3  (pre-ner)      : tmdb
Stage 4  (silero-vad)   : pre-ner (and audio from demux)
Stage 5  (pyannote-vad) : silero-vad (and audio from demux)
Stage 6  (diarization)  : pyannote-vad (and audio from demux)
Stage 7  (asr)          : diarization (and audio, vad, prompt)
Stage 8  (post-ner)     : asr (and tmdb metadata)
Stage 9  (subtitle-gen) : post-ner (and speaker info from diarization)
Stage 10 (mux)          : subtitle-gen (and original video)


KEY CHARACTERISTICS
===================
âœ“ All stages run sequentially (one after another)
âœ“ Each stage depends on the previous stage completing successfully
âœ“ All stages are critical (pipeline stops on any failure)
âœ“ Output files validated after each stage
âœ“ Manifest tracking enabled for resume capability
âœ“ Detailed logging for each stage
âœ“ Configurable timeouts per stage


TOTAL ESTIMATED TIME
====================
Minimum: ~3.5 hours (all stages complete quickly)
Maximum: ~5 hours (stages use full timeout)

Actual time depends on:
- Video length
- Hardware (CPU vs GPU)
- Model sizes
- Audio complexity


PARALLELIZATION OPPORTUNITIES (FUTURE)
=======================================
1. Stages 4-6 (VAD stages) could potentially run in parallel
2. Stages 3 and 4 could potentially run in parallel
3. Audio could be chunked for parallel ASR processing
4. Multiple videos could be processed simultaneously
